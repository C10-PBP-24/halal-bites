{% load static %}

{% block meta %}
<title>Food Tracker</title>
<link rel="stylesheet" href="{% static 'tracker/style.css' %}">
{% endblock meta %}

{% block content %}
<div class="container">
    <main>
        <div class="tracker-section">
            {% if food_tracker %}
                <h2>Your Food Tracker</h2>
                <ul>
                    {% for track in food_tracker %}
                        <li>{{ track.food.name }} at {{ track.restaurant.name }} - Rated {{ track.rating.score }} by you on {{ track.order_at|date:"F j, Y" }}</li>
                    {% endfor %}
                </ul>
            {% else %}
                <h2>Food Tracker is Empty ðŸ˜¢</h2>
                <p>Track your orders now!</p>
            {% endif %}
            <button id="add-tracking-btn">+ Add Food Tracking</button>
        </div>

        <!-- Form to Add Food Tracking -->
        <div id="add-tracking-form" class="hidden">
            <h2>Add Food Tracking</h2>
            <form method="post" action="{% url 'tracker:add_food_tracking' %}">
                {% csrf_token %}
                <label for="food">Food Title:</label>
                <select name="food" id="food" required>
                    {% for food in ordered_foods %}
                        <option value="{{ food.id }}">{{ food.name }}</option>
                    {% endfor %}
                </select>

                <label for="rating">Rating:</label>
                <select name="rating" id="rating" required>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                </select>

                <label for="order_at">Order Date:</label>
                <input type="date" name="order_at" id="order_at" required>

                <button type="submit">Submit</button>
            </form>
        </div>
    </main>
</div>
{% endblock content %}

{% block script %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const addTrackingBtn = document.getElementById('add-tracking-btn');
        const addTrackingForm = document.getElementById('add-tracking-form');

        addTrackingBtn.addEventListener('click', () => {
            addTrackingForm.classList.toggle('hidden');
        });
    });
</script>
{% endblock script %}
